<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Biomarker Kinetics Model — biokinetics • epikinetics</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Biomarker Kinetics Model — biokinetics"><meta property="og:description" content="Create an instance of the biomarker kinetics model and
fit it to a dataset."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">


    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">epikinetics</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.0.0.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles

    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/biokinetics.html">biokinetics case study</a>
    </li>
    <li>
      <a href="../articles/data.html">A guide to model input and output data</a>
    </li>
    <li>
      <a href="../articles/model.html">Model</a>
    </li>
  </ul></li>
      </ul><ul class="nav navbar-nav navbar-right"></ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->



      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Biomarker Kinetics Model</h1>

    <div class="hidden name"><code>biokinetics.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Create an instance of the biomarker kinetics model and
fit it to a dataset.</p>
    </div>


    <div id="methods">
    <h2>Methods</h2>

<div class="section">
<h3 id="public-methods">Public methods<a class="anchor" aria-label="anchor" href="#public-methods"></a></h3>

<ul><li><p><a href="#method-biokinetics-new"><code>biokinetics$new()</code></a></p></li>
<li><p><a href="#method-biokinetics-get_stan_data"><code>biokinetics$get_stan_data()</code></a></p></li>
<li><p><a href="#method-biokinetics-fit"><code>biokinetics$fit()</code></a></p></li>
<li><p><a href="#method-biokinetics-extract_population_parameters"><code>biokinetics$extract_population_parameters()</code></a></p></li>
<li><p><a href="#method-biokinetics-extract_individual_parameters"><code>biokinetics$extract_individual_parameters()</code></a></p></li>
<li><p><a href="#method-biokinetics-simulate_population_trajectories"><code>biokinetics$simulate_population_trajectories()</code></a></p></li>
<li><p><a href="#method-biokinetics-population_stationary_points"><code>biokinetics$population_stationary_points()</code></a></p></li>
<li><p><a href="#method-biokinetics-simulate_individual_trajectories"><code>biokinetics$simulate_individual_trajectories()</code></a></p></li>
</ul></div><p></p><hr><a id="method-biokinetics-new"></a><div class="section">
<h3 id="method-new-">Method <code>new()</code><a class="anchor" aria-label="anchor" href="#method-new-"></a></h3>
<p>Initialise the kinetics model.</p><div class="section">
<h4 id="usage">Usage<a class="anchor" aria-label="anchor" href="#usage"></a></h4>
<p></p><div class="r"><div class="sourceCode"><pre><code><span><span class="va"><a href="../reference/biokinetics.html">biokinetics</a></span><span class="op">$</span><span class="fu">new</span><span class="op">(</span></span>
<span>  priors <span class="op">=</span> <span class="fu"><a href="../reference/biokinetics_priors.html">biokinetics_priors</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  data <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  file_path <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  covariate_formula <span class="op">=</span> <span class="op">~</span><span class="fl">0</span>,</span>
<span>  preds_sd <span class="op">=</span> <span class="fl">0.25</span></span>
<span><span class="op">)</span></span></code></pre></div><p></p></div>
</div>

<div class="section">
<h4 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h4>
<p></p><div class="arguments"><dl><dt><code>priors</code></dt>
<dd><p>Object of type <a href="biokinetics_priors.html">biokinetics_priors</a>. Default biokinetics_priors().</p></dd>


<dt><code>data</code></dt>
<dd><p>Optional data table of model inputs. One of data or file must be provided. See the data vignette
for required columns: <code><a href="../articles/data.html">vignette("data", package = "epikinetics")</a></code>.</p></dd>


<dt><code>file_path</code></dt>
<dd><p>Optional file path to model inputs in CSV format. One of data or file must be provided.</p></dd>


<dt><code>covariate_formula</code></dt>
<dd><p>Formula specifying linear regression model. Note all variables in the formula
will be treated as categorical variables. Default ~0.</p></dd>


<dt><code>preds_sd</code></dt>
<dd><p>Standard deviation of predictor coefficients. Default 0.25.</p></dd>


</dl><p></p></div>
</div>
<div class="section">
<h4 id="returns">Returns<a class="anchor" aria-label="anchor" href="#returns"></a></h4>
<p>An epikinetics::biokinetics object.</p>
</div>

</div><p></p><hr><a id="method-biokinetics-get_stan_data"></a><div class="section">
<h3 id="method-get-stan-data-">Method <code>get_stan_data()</code><a class="anchor" aria-label="anchor" href="#method-get-stan-data-"></a></h3>
<p>View the data that is passed to the stan model, for debugging purposes.</p><div class="section">
<h4 id="usage-1">Usage<a class="anchor" aria-label="anchor" href="#usage-1"></a></h4>
<p></p><div class="r"><div class="sourceCode"><pre><code><span><span class="va">biokinetics</span><span class="op">$</span><span class="fu">get_stan_data</span><span class="op">(</span><span class="op">)</span></span></code></pre></div><p></p></div>
</div>

<div class="section">
<h4 id="returns-1">Returns<a class="anchor" aria-label="anchor" href="#returns-1"></a></h4>
<p>A list of arguments that will be passed to the stan model.</p>
</div>

</div><p></p><hr><a id="method-biokinetics-fit"></a><div class="section">
<h3 id="method-fit-">Method <code>fit()</code><a class="anchor" aria-label="anchor" href="#method-fit-"></a></h3>
<p>Fit the model and return CmdStanMCMC fitted model object.</p><div class="section">
<h4 id="usage-2">Usage<a class="anchor" aria-label="anchor" href="#usage-2"></a></h4>
<p></p><div class="r"><div class="sourceCode"><pre><code><span><span class="va">biokinetics</span><span class="op">$</span><span class="fu">fit</span><span class="op">(</span><span class="va">...</span><span class="op">)</span></span></code></pre></div><p></p></div>
</div>

<div class="section">
<h4 id="arguments-1">Arguments<a class="anchor" aria-label="anchor" href="#arguments-1"></a></h4>
<p></p><div class="arguments"><dl><dt><code>...</code></dt>
<dd><p>Named arguments to the <code><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample()</a></code> method of CmdStan model.
objects: <a href="https://mc-stan.org/cmdstanr/reference/model-method-sample.html" class="external-link">https://mc-stan.org/cmdstanr/reference/model-method-sample.html</a></p></dd>


</dl><p></p></div>
</div>
<div class="section">
<h4 id="returns-2">Returns<a class="anchor" aria-label="anchor" href="#returns-2"></a></h4>
<p>A CmdStanMCMC fitted model object: <a href="https://mc-stan.org/cmdstanr/reference/CmdStanMCMC.html" class="external-link">https://mc-stan.org/cmdstanr/reference/CmdStanMCMC.html</a></p>
</div>

</div><p></p><hr><a id="method-biokinetics-extract_population_parameters"></a><div class="section">
<h3 id="method-extract-population-parameters-">Method <code>extract_population_parameters()</code><a class="anchor" aria-label="anchor" href="#method-extract-population-parameters-"></a></h3>
<p>Extract fitted population parameters</p><div class="section">
<h4 id="usage-3">Usage<a class="anchor" aria-label="anchor" href="#usage-3"></a></h4>
<p></p><div class="r"><div class="sourceCode"><pre><code><span><span class="va">biokinetics</span><span class="op">$</span><span class="fu">extract_population_parameters</span><span class="op">(</span></span>
<span>  n_draws <span class="op">=</span> <span class="fl">2500</span>,</span>
<span>  human_readable_covariates <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span></code></pre></div><p></p></div>
</div>

<div class="section">
<h4 id="arguments-2">Arguments<a class="anchor" aria-label="anchor" href="#arguments-2"></a></h4>
<p></p><div class="arguments"><dl><dt><code>n_draws</code></dt>
<dd><p>Numeric</p></dd>


<dt><code>human_readable_covariates</code></dt>
<dd><p>Logical. Default TRUE.</p></dd>


</dl><p></p></div>
</div>
<div class="section">
<h4 id="returns-3">Returns<a class="anchor" aria-label="anchor" href="#returns-3"></a></h4>
<p>A data.table</p>
</div>

</div><p></p><hr><a id="method-biokinetics-extract_individual_parameters"></a><div class="section">
<h3 id="method-extract-individual-parameters-">Method <code>extract_individual_parameters()</code><a class="anchor" aria-label="anchor" href="#method-extract-individual-parameters-"></a></h3>
<p>Extract fitted individual parameters</p><div class="section">
<h4 id="usage-4">Usage<a class="anchor" aria-label="anchor" href="#usage-4"></a></h4>
<p></p><div class="r"><div class="sourceCode"><pre><code><span><span class="va">biokinetics</span><span class="op">$</span><span class="fu">extract_individual_parameters</span><span class="op">(</span></span>
<span>  n_draws <span class="op">=</span> <span class="fl">2500</span>,</span>
<span>  include_variation_params <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  human_readable_covariates <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span></code></pre></div><p></p></div>
</div>

<div class="section">
<h4 id="arguments-3">Arguments<a class="anchor" aria-label="anchor" href="#arguments-3"></a></h4>
<p></p><div class="arguments"><dl><dt><code>n_draws</code></dt>
<dd><p>Numeric</p></dd>


<dt><code>include_variation_params</code></dt>
<dd><p>Logical</p></dd>


<dt><code>human_readable_covariates</code></dt>
<dd><p>Logical. Default TRUE.</p></dd>


</dl><p></p></div>
</div>
<div class="section">
<h4 id="returns-4">Returns<a class="anchor" aria-label="anchor" href="#returns-4"></a></h4>
<p>A data.table</p>
</div>

</div><p></p><hr><a id="method-biokinetics-simulate_population_trajectories"></a><div class="section">
<h3 id="method-simulate-population-trajectories-">Method <code>simulate_population_trajectories()</code><a class="anchor" aria-label="anchor" href="#method-simulate-population-trajectories-"></a></h3>
<p>Process the model results into a data table of titre values over time.</p><div class="section">
<h4 id="usage-5">Usage<a class="anchor" aria-label="anchor" href="#usage-5"></a></h4>
<p></p><div class="r"><div class="sourceCode"><pre><code><span><span class="va">biokinetics</span><span class="op">$</span><span class="fu">simulate_population_trajectories</span><span class="op">(</span></span>
<span>  t_max <span class="op">=</span> <span class="fl">150</span>,</span>
<span>  summarise <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  n_draws <span class="op">=</span> <span class="fl">2500</span></span>
<span><span class="op">)</span></span></code></pre></div><p></p></div>
</div>

<div class="section">
<h4 id="arguments-4">Arguments<a class="anchor" aria-label="anchor" href="#arguments-4"></a></h4>
<p></p><div class="arguments"><dl><dt><code>t_max</code></dt>
<dd><p>Integer. Maximum number of time points to include.</p></dd>


<dt><code>summarise</code></dt>
<dd><p>Boolean. Default TRUE. If TRUE, summarises over draws from posterior parameter distributions to
return 0.025, 0.5 and 0.975 quantiles, labelled lo, me and hi, respectively. If FALSE returns values for individual
draws from posterior parameter distributions.</p></dd>


<dt><code>n_draws</code></dt>
<dd><p>Integer. Maximum number of samples to include. Default 2500.</p></dd>


</dl><p></p></div>
</div>
<div class="section">
<h4 id="returns-5">Returns<a class="anchor" aria-label="anchor" href="#returns-5"></a></h4>
<p>A data.table containing titre values at time points. If summarise = TRUE, columns are time_since_last_exp,
me, lo, hi, titre_type, and a column for each covariate in the hierarchical model. If summarise = FALSE, columns are
time_since_last_exp, .draw, t0_pop, tp_pop, ts_pop, m1_pop, m2_pop, m3_pop, beta_t0, beta_tp, beta_ts, beta_m1, beta_m2, beta_m3, mu
titre_type and a column for each covariate in the hierarchical model. See the data vignette for details:
<code><a href="../articles/data.html">vignette("data", package = "epikinetics")</a></code></p>
</div>

</div><p></p><hr><a id="method-biokinetics-population_stationary_points"></a><div class="section">
<h3 id="method-population-stationary-points-">Method <code>population_stationary_points()</code><a class="anchor" aria-label="anchor" href="#method-population-stationary-points-"></a></h3>
<p>Process the stan model results into a data.table.</p><div class="section">
<h4 id="usage-6">Usage<a class="anchor" aria-label="anchor" href="#usage-6"></a></h4>
<p></p><div class="r"><div class="sourceCode"><pre><code><span><span class="va">biokinetics</span><span class="op">$</span><span class="fu">population_stationary_points</span><span class="op">(</span>n_draws <span class="op">=</span> <span class="fl">2500</span><span class="op">)</span></span></code></pre></div><p></p></div>
</div>

<div class="section">
<h4 id="arguments-5">Arguments<a class="anchor" aria-label="anchor" href="#arguments-5"></a></h4>
<p></p><div class="arguments"><dl><dt><code>n_draws</code></dt>
<dd><p>Integer. Maximum number of samples to include. Default 2500.</p></dd>


</dl><p></p></div>
</div>
<div class="section">
<h4 id="returns-6">Returns<a class="anchor" aria-label="anchor" href="#returns-6"></a></h4>
<p>A data.table of peak and set titre values. Columns are tire_type, mu_p, mu_s, rel_drop_me, mu_p_me,
mu_s_me, and a column for each covariate. See the data vignette for details:
<code><a href="../articles/data.html">vignette("data", package = "epikinetics")</a></code></p>
</div>

</div><p></p><hr><a id="method-biokinetics-simulate_individual_trajectories"></a><div class="section">
<h3 id="method-simulate-individual-trajectories-">Method <code>simulate_individual_trajectories()</code><a class="anchor" aria-label="anchor" href="#method-simulate-individual-trajectories-"></a></h3>
<p>Simulate individual trajectories from the model. This is
computationally expensive and may take a while to run if n_draws is large.</p><div class="section">
<h4 id="usage-7">Usage<a class="anchor" aria-label="anchor" href="#usage-7"></a></h4>
<p></p><div class="r"><div class="sourceCode"><pre><code><span><span class="va">biokinetics</span><span class="op">$</span><span class="fu">simulate_individual_trajectories</span><span class="op">(</span></span>
<span>  summarise <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  n_draws <span class="op">=</span> <span class="fl">2500</span>,</span>
<span>  time_shift <span class="op">=</span> <span class="fl">0</span></span>
<span><span class="op">)</span></span></code></pre></div><p></p></div>
</div>

<div class="section">
<h4 id="arguments-6">Arguments<a class="anchor" aria-label="anchor" href="#arguments-6"></a></h4>
<p></p><div class="arguments"><dl><dt><code>summarise</code></dt>
<dd><p>Boolean. If TRUE, average the individual trajectories to get lo, me and
hi values for the population, disaggregated by titre type. If FALSE return the indidivudal trajectories.
Default TRUE.</p></dd>


<dt><code>n_draws</code></dt>
<dd><p>Integer. Maximum number of samples to draw. Default 2500.</p></dd>


<dt><code>time_shift</code></dt>
<dd><p>Integer. Number of days to adjust the exposure day by. Default 0.</p></dd>


</dl><p></p></div>
</div>
<div class="section">
<h4 id="returns-7">Returns<a class="anchor" aria-label="anchor" href="#returns-7"></a></h4>
<p>A data.table. If summarise = TRUE columns are calendar_date, titre_type, me, lo, hi, time_shift.
If summarise = FALSE, columns are pid, draw, time_since_last_exp, mu, titre_type, exposure_day, calendar_day, time_shift
and a column for each covariate in the regression model. See the data vignette for details:
<code><a href="../articles/data.html">vignette("data", package = "epikinetics")</a></code>.</p>
</div>

</div>

    </div>

  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Timothy Russell, Alex Hill.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

      </footer></div>






  </body></html>

