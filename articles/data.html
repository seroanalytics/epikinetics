<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>A guide to model input and output data • epikinetics</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="A guide to model input and output data">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">


    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">epikinetics</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.0.0.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles

    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/biokinetics.html">biokinetics case study</a>
    </li>
    <li>
      <a href="../articles/data.html">A guide to model input and output data</a>
    </li>
    <li>
      <a href="../articles/model.html">Model</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->



      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>A guide to model input and output data</h1>
            
      

      <div class="hidden name"><code>data.Rmd</code></div>

    </div>

    
    
<div class="section level2">
<h2 id="input-data">Input data<a class="anchor" aria-label="anchor" href="#input-data"></a>
</h2>
<p>The model requires time series data about individual titre readings,
along with last exposure times. Times can be relative (e.g. day of
study) or absolute (i.e. precise calendar dates). The full list of
required columns is as follows:</p>
<table class="table">
<colgroup>
<col width="10%">
<col width="16%">
<col width="67%">
<col width="5%">
</colgroup>
<thead><tr class="header">
<th>name</th>
<th>type</th>
<th>description</th>
<th>required</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>pid</td>
<td>numeric or character</td>
<td>Unique identifier to identify a person across observations</td>
<td>T</td>
</tr>
<tr class="even">
<td>day</td>
<td>integer or date</td>
<td>The day of the observation. Can be a date or an integer representing
a relative day of study</td>
<td>T</td>
</tr>
<tr class="odd">
<td>last_exp_day</td>
<td>integer or date</td>
<td>The most recent day on which the person was exposed. Must be of the
same type as the ‘day’ column</td>
<td>T</td>
</tr>
<tr class="even">
<td>titre_type</td>
<td>character</td>
<td>Name of the titre or biomarker</td>
<td>T</td>
</tr>
<tr class="odd">
<td>value</td>
<td>numeric</td>
<td>Titre value</td>
<td>T</td>
</tr>
<tr class="even">
<td>censored</td>
<td>-1, 0 or 1</td>
<td>Optional column. Whether this observation should be treated as
censored: -1 for lower, 1 for upper, 0 for none.</td>
<td>F</td>
</tr>
</tbody>
</table>
<p>It can also contain further columns for any covariates to be included
in the model. The data files installed with this package have additional
columns infection_history, last_vax_type, and exp_num.</p>
<p>The model also accepts a covariate formula to define the regression
model. The variables in the formula must correspond to column names in
the dataset. Note that all variables will be treated as
<strong>categorical variables</strong>; that is, converted to factors
regardless of their input type.</p>
<p>Note also that the <code>value</code> column is assumed to be on a
natural scale by default, and will be converted to a log scale for model
fitting. If your data is already on a log scale, you must pass the
<code>log=TRUE</code> argument when initialising the biokinetics class.
See <a href="../reference/biokinetics.html">biokinetics</a>.</p>
<div class="section level3">
<h3 id="example">Example<a class="anchor" aria-label="anchor" href="#example"></a>
</h3>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dat</span> <span class="op">&lt;-</span> <span class="fu">data.table</span><span class="fu">::</span><span class="fu"><a href="https://rdatatable.gitlab.io/data.table/reference/fread.html" class="external-link">fread</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"delta_full.rds"</span>, package <span class="op">=</span> <span class="st">"epikinetics"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">dat</span><span class="op">)</span></span>
<span><span class="co">#&gt;      pid        day last_exp_day titre_type    value censored infection_history</span></span>
<span><span class="co">#&gt;    &lt;int&gt;     &lt;IDat&gt;       &lt;IDat&gt;     &lt;char&gt;    &lt;num&gt;    &lt;int&gt;            &lt;char&gt;</span></span>
<span><span class="co">#&gt; 1:     1 2021-03-10   2021-03-08  Ancestral 175.9350        0   Infection naive</span></span>
<span><span class="co">#&gt; 2:     1 2021-04-15   2021-03-08  Ancestral 607.5750        0   Infection naive</span></span>
<span><span class="co">#&gt; 3:     1 2021-07-08   2021-03-08  Ancestral 179.0463        0   Infection naive</span></span>
<span><span class="co">#&gt; 4:     1 2021-03-10   2021-03-08      Alpha   5.0000       -1   Infection naive</span></span>
<span><span class="co">#&gt; 5:     1 2021-04-15   2021-03-08      Alpha 416.7905        0   Infection naive</span></span>
<span><span class="co">#&gt; 6:     1 2021-07-08   2021-03-08      Alpha 103.5274        0   Infection naive</span></span>
<span><span class="co">#&gt;    last_vax_type exp_num</span></span>
<span><span class="co">#&gt;           &lt;char&gt;   &lt;int&gt;</span></span>
<span><span class="co">#&gt; 1:      BNT162b2       2</span></span>
<span><span class="co">#&gt; 2:      BNT162b2       2</span></span>
<span><span class="co">#&gt; 3:      BNT162b2       2</span></span>
<span><span class="co">#&gt; 4:      BNT162b2       2</span></span>
<span><span class="co">#&gt; 5:      BNT162b2       2</span></span>
<span><span class="co">#&gt; 6:      BNT162b2       2</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="ouput-data">Ouput data<a class="anchor" aria-label="anchor" href="#ouput-data"></a>
</h2>
<p>After fitting a model, a <a href="https://mc-stan.org/cmdstanr/reference/CmdStanMCMC.html" class="external-link">CmdStanMCMC</a>
object is returned. This means that users who are already familiar with
<code>cmdstanr</code> are free to do what they want with the fitted
model.</p>
<p><strong>Important!</strong> <strong>If you provide data on a natural
scale, it will be converted to a base2 log scale before inference is
performed. This means that if working directly with the fitted
<code>CmdStanMCMC</code> all values will be on this scale. The package
provides a helper function for converting back to the original scale: <a href="../reference/convert_log_scale_inverse.html">convert_log_scale_inverse</a>.</strong></p>
<p>Three further functions provide model outputs that we think are
particularly useful in <a href="https://cran.r-project.org/web/packages/data.table/" class="external-link">data.table</a>
format. <a href="../reference/biokinetics.html">biokinetics</a> contains
documentation on each of these functions so please read that first; this
Vignette provides guidance on the correct interpretation of each column
in the returned tables. (In these functions data is returned on the
original scale).</p>
<div class="section level3">
<h3 id="simulate_population_trajectories">simulate_population_trajectories<a class="anchor" aria-label="anchor" href="#simulate_population_trajectories"></a>
</h3>
<p>See the documentation for this function <a href="../reference/biokinetics.html#method-simulate-population-trajectories">here</a>.
There are 2 different output formats depending on whether the provided
<code>summarise</code> argument is <code>TRUE</code> or
<code>FALSE</code>.</p>
<div class="section level4">
<h4 id="summarise-true">summarise = TRUE<a class="anchor" aria-label="anchor" href="#summarise-true"></a>
</h4>
<p>Returned columns are</p>
<table class="table">
<colgroup>
<col width="16%">
<col width="9%">
<col width="74%">
</colgroup>
<thead><tr class="header">
<th>name</th>
<th>type</th>
<th>description</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>time_since_last_exp</td>
<td>integer</td>
<td>Number of days since last exposure</td>
</tr>
<tr class="even">
<td>me</td>
<td>numeric</td>
<td>Median titre value</td>
</tr>
<tr class="odd">
<td>lo</td>
<td>numeric</td>
<td>Titre value at the 0.025 quantile</td>
</tr>
<tr class="even">
<td>hi</td>
<td>numeric</td>
<td>Titre value at the 0.975 quantile</td>
</tr>
<tr class="odd">
<td>titre_type</td>
<td>character</td>
<td>Name of the titre or biomarker</td>
</tr>
<tr class="even">
<td>censored</td>
<td>-1, 0 or 1</td>
<td>Whether this observation should be treated as censored: -1 for
lower, 1 for upper, 0 for none</td>
</tr>
</tbody>
</table>
<p>There will also be a column for each covariate in the regression
model.</p>
</div>
<div class="section level4">
<h4 id="summarise-false">summarise = FALSE<a class="anchor" aria-label="anchor" href="#summarise-false"></a>
</h4>
<p>Returned columns are</p>
<table class="table">
<thead><tr class="header">
<th>name</th>
<th>type</th>
<th>description</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>time_since_last_exp</td>
<td>integer</td>
<td>Number of days since last exposure</td>
</tr>
<tr class="even">
<td>t0_pop</td>
<td>numeric</td>
<td></td>
</tr>
<tr class="odd">
<td>tp_pop</td>
<td>numeric</td>
<td></td>
</tr>
<tr class="even">
<td>ts_pop</td>
<td>numeric</td>
<td></td>
</tr>
<tr class="odd">
<td>m1_pop</td>
<td>numeric</td>
<td></td>
</tr>
<tr class="even">
<td>m2_pop</td>
<td>numeric</td>
<td></td>
</tr>
<tr class="odd">
<td>m3_pop</td>
<td>numeric</td>
<td></td>
</tr>
<tr class="even">
<td>beta_t0</td>
<td>numeric</td>
<td></td>
</tr>
<tr class="odd">
<td>beta_tp</td>
<td>numeric</td>
<td></td>
</tr>
<tr class="even">
<td>beta_ts</td>
<td>numeric</td>
<td></td>
</tr>
<tr class="odd">
<td>beta_m1</td>
<td>numeric</td>
<td></td>
</tr>
<tr class="even">
<td>beta_m2</td>
<td>numeric</td>
<td></td>
</tr>
<tr class="odd">
<td>beta_t3</td>
<td>numeric</td>
<td></td>
</tr>
<tr class="even">
<td>mu</td>
<td>numeric</td>
<td>Titre value</td>
</tr>
<tr class="odd">
<td>.draw</td>
<td>integer</td>
<td>Draw number</td>
</tr>
<tr class="even">
<td>titre_type</td>
<td>numeric</td>
<td>Name of the titre or biomarker</td>
</tr>
</tbody>
</table>
<p>There will also be column for each covariate in the hierarchical
model.</p>
</div>
</div>
<div class="section level3">
<h3 id="simulate_individual_trajectories">simulate_individual_trajectories<a class="anchor" aria-label="anchor" href="#simulate_individual_trajectories"></a>
</h3>
<p>See the documentation for this function <a href="../reference/biokinetics.html#method-simulate-individual-trajectories">here</a>.
There are 2 different output formats depending on whether the provided
<code>summarise</code> argument is <code>TRUE</code> or
<code>FALSE</code>.</p>
<div class="section level4">
<h4 id="summarise-false-1">summarise = FALSE<a class="anchor" aria-label="anchor" href="#summarise-false-1"></a>
</h4>
<p>Returned columns are</p>
<table class="table">
<colgroup>
<col width="15%">
<col width="16%">
<col width="68%">
</colgroup>
<thead><tr class="header">
<th>name</th>
<th>type</th>
<th>description</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>pid</td>
<td>character or numeric</td>
<td>Unique person identifier as provided in input data</td>
</tr>
<tr class="even">
<td>draw</td>
<td>integer</td>
<td>Which draw from the fits this is</td>
</tr>
<tr class="odd">
<td>time_since_last_exp</td>
<td>integer</td>
<td>Number of days since last exposure</td>
</tr>
<tr class="even">
<td>mu</td>
<td>numeric</td>
<td>Titre value</td>
</tr>
<tr class="odd">
<td>titre_type</td>
<td>character</td>
<td>Name of the titre or biomarker</td>
</tr>
<tr class="even">
<td>exposure_day</td>
<td>integer</td>
<td>Day of this person’s last exposure</td>
</tr>
<tr class="odd">
<td>calendar_day</td>
<td>integer</td>
<td>Day of this titre value</td>
</tr>
<tr class="even">
<td>time_shift</td>
<td>integer</td>
<td>The number of days these exposures have been adjusted by, as
provided in function arguments</td>
</tr>
</tbody>
</table>
<p>There will also be a column for each covariate in the regression
model.</p>
</div>
<div class="section level4">
<h4 id="summarise-true-1">summarise = TRUE<a class="anchor" aria-label="anchor" href="#summarise-true-1"></a>
</h4>
<p>Returned columns are</p>
<table class="table">
<colgroup>
<col width="12%">
<col width="9%">
<col width="77%">
</colgroup>
<thead><tr class="header">
<th>name</th>
<th>type</th>
<th>description</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>me</td>
<td>numeric</td>
<td>Median titre value</td>
</tr>
<tr class="even">
<td>lo</td>
<td>numeric</td>
<td>Titre value at the 0.025 quantile</td>
</tr>
<tr class="odd">
<td>hi</td>
<td>numeric</td>
<td>Titre value at the 0.075 quantile</td>
</tr>
<tr class="even">
<td>titre_type</td>
<td>character</td>
<td>Name of the titre or biomarker</td>
</tr>
<tr class="odd">
<td>calendar_day</td>
<td>integer</td>
<td>Day of this titre value</td>
</tr>
<tr class="even">
<td>time_shift</td>
<td>integer</td>
<td>The number of days the exposures were adjusted by, as provided in
function arguments</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

      </div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Timothy Russell, Alex Hill.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

      </footer>
</div>






  </body>
</html>
